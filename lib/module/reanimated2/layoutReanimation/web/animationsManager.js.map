{"version":3,"names":["Animations","LayoutAnimationType","createAnimationWithExistingTransform","extractTransformFromStyle","getProcessedConfig","handleEnteringAnimation","handleExitingAnimation","handleLayoutTransition","makeElementVisible","areDOMRectsEqual","chooseConfig","animationType","props","config","ENTERING","entering","EXITING","exiting","LAYOUT","layout","checkUndefinedAnimationFail","initialAnimationName","isLayoutTransition","hasEnteringAnimation","element","console","warn","checkReduceMotionFail","animationConfig","reduceMotion","chooseAction","transitionData","transform","reversed","startWebLayoutAnimation","undefined","name","constructor","shouldFail","style","animationName","tryActivateLayoutTransition","snapshot","rect","getBoundingClientRect","translateX","x","translateY","y","scaleX","width","scaleY","height"],"sources":["animationsManager.ts"],"sourcesContent":["'use strict';\n\nimport type { AnimationConfig, AnimationNames, CustomConfig } from './config';\nimport { Animations } from './config';\nimport type { AnimatedComponentProps } from '../../../createAnimatedComponent/commonTypes';\nimport { LayoutAnimationType } from '../animationBuilder/commonTypes';\nimport type { StyleProps } from '../../commonTypes';\nimport { createAnimationWithExistingTransform } from './createAnimation';\nimport {\n  extractTransformFromStyle,\n  getProcessedConfig,\n  handleEnteringAnimation,\n  handleExitingAnimation,\n  handleLayoutTransition,\n  makeElementVisible,\n} from './componentUtils';\nimport { areDOMRectsEqual } from './domUtils';\nimport type { TransformsStyle } from 'react-native';\nimport type { TransitionData } from './animationParser';\n\nfunction chooseConfig<ComponentProps extends Record<string, unknown>>(\n  animationType: LayoutAnimationType,\n  props: Readonly<AnimatedComponentProps<ComponentProps>>\n) {\n  const config =\n    animationType === LayoutAnimationType.ENTERING\n      ? props.entering\n      : animationType === LayoutAnimationType.EXITING\n      ? props.exiting\n      : animationType === LayoutAnimationType.LAYOUT\n      ? props.layout\n      : null;\n\n  return config;\n}\n\nfunction checkUndefinedAnimationFail(\n  initialAnimationName: string,\n  isLayoutTransition: boolean,\n  hasEnteringAnimation: boolean,\n  element: HTMLElement\n) {\n  // This prevents crashes if we try to set animations that are not defined.\n  // We don't care about layout transitions since they're created dynamically\n  if (initialAnimationName in Animations || isLayoutTransition) {\n    return false;\n  }\n\n  if (hasEnteringAnimation) {\n    makeElementVisible(element);\n  }\n\n  console.warn(\n    \"[Reanimated] Couldn't load entering/exiting animation. Current version supports only predefined animations with modifiers: duration, delay, easing, randomizeDelay, wtihCallback, reducedMotion.\"\n  );\n\n  return true;\n}\n\nfunction checkReduceMotionFail(\n  animationConfig: AnimationConfig,\n  hasEnteringAnimation: boolean,\n  element: HTMLElement\n) {\n  if (!animationConfig.reduceMotion) {\n    return false;\n  }\n\n  if (hasEnteringAnimation) {\n    makeElementVisible(element);\n  }\n\n  return true;\n}\n\nfunction chooseAction(\n  animationType: LayoutAnimationType,\n  animationConfig: AnimationConfig,\n  element: HTMLElement,\n  transitionData: TransitionData,\n  transform: TransformsStyle['transform'] | undefined\n) {\n  switch (animationType) {\n    case LayoutAnimationType.ENTERING:\n      handleEnteringAnimation(element, animationConfig);\n      break;\n    case LayoutAnimationType.LAYOUT:\n      transitionData.reversed = animationConfig.reversed;\n\n      handleLayoutTransition(\n        element,\n        animationConfig,\n        transitionData,\n        transform\n      );\n      break;\n    case LayoutAnimationType.EXITING:\n      handleExitingAnimation(element, animationConfig);\n      break;\n  }\n}\n\nexport function startWebLayoutAnimation<\n  ComponentProps extends Record<string, unknown>\n>(\n  props: Readonly<AnimatedComponentProps<ComponentProps>>,\n  element: HTMLElement,\n  animationType: LayoutAnimationType,\n  transitionData?: TransitionData\n) {\n  const config = chooseConfig(animationType, props);\n  if (!config) {\n    return;\n  }\n\n  const hasEnteringAnimation = props.entering !== undefined;\n  const isLayoutTransition = animationType === LayoutAnimationType.LAYOUT;\n  const initialAnimationName =\n    typeof config === 'function' ? config.name : config.constructor.name;\n\n  const shouldFail = checkUndefinedAnimationFail(\n    initialAnimationName,\n    isLayoutTransition,\n    hasEnteringAnimation,\n    element\n  );\n\n  if (shouldFail) {\n    return;\n  }\n\n  const transform = extractTransformFromStyle(props.style as StyleProps);\n\n  const animationName = transform\n    ? createAnimationWithExistingTransform(initialAnimationName, transform)\n    : initialAnimationName;\n\n  const animationConfig = getProcessedConfig(\n    animationName,\n    config as CustomConfig,\n    isLayoutTransition,\n    initialAnimationName as AnimationNames\n  );\n\n  if (checkReduceMotionFail(animationConfig, hasEnteringAnimation, element)) {\n    return;\n  }\n\n  chooseAction(\n    animationType,\n    animationConfig,\n    element,\n    transitionData as TransitionData,\n    transform\n  );\n}\n\nexport function tryActivateLayoutTransition<\n  ComponentProps extends Record<string, unknown>\n>(\n  props: Readonly<AnimatedComponentProps<ComponentProps>>,\n  element: HTMLElement,\n  snapshot: DOMRect\n) {\n  if (!props.layout) {\n    return;\n  }\n\n  const rect = element.getBoundingClientRect();\n\n  if (areDOMRectsEqual(rect, snapshot)) {\n    return;\n  }\n\n  const transitionData: TransitionData = {\n    translateX: snapshot.x - rect.x,\n    translateY: snapshot.y - rect.y,\n    scaleX: snapshot.width / rect.width,\n    scaleY: snapshot.height / rect.height,\n    reversed: false, // This field is used only in `SequencedTransition`, so by default it will be false\n  };\n\n  startWebLayoutAnimation(\n    props,\n    element,\n    LayoutAnimationType.LAYOUT,\n    transitionData\n  );\n}\n"],"mappings":"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"}