{"version":3,"names":["FrameCallbackRegistry","Map","Set","runAnimation","loop","frameCallbackActive","forEach","key","callback","frameCallbackRegistry","get","size","requestAnimationFrame","isFrameCallbackRunning","registerFrameCallback","callbackId","nextCallbackId","set","unregisterFrameCallback","frameCallbackId","manageStateFrameCallback","delete","state","add"],"sources":["FrameCallbackRegistry.ts"],"sourcesContent":["export default class FrameCallbackRegistry {\n  private nextCallbackId = 0;\n  private frameCallbackRegistry = new Map<number, () => void>();\n  private frameCallbackActive = new Set<number>();\n  private isFrameCallbackRunning = false;\n\n  private runAnimation() {\n    const loop = () => {\n      this.frameCallbackActive.forEach((key) => {\n        const callback = this.frameCallbackRegistry.get(key);\n        callback!();\n      });\n\n      if (this.frameCallbackActive.size > 0) {\n        requestAnimationFrame(loop);\n      } else {\n        this.isFrameCallbackRunning = false;\n      }\n    };\n\n    if (!this.isFrameCallbackRunning) {\n      requestAnimationFrame(loop);\n      this.isFrameCallbackRunning = true;\n    }\n  }\n\n  registerFrameCallback(callback: () => void): number {\n    if (!callback) {\n      return -1;\n    }\n    const callbackId = this.nextCallbackId;\n    this.nextCallbackId++;\n    this.frameCallbackRegistry.set(callbackId, callback);\n\n    return callbackId;\n  }\n\n  unregisterFrameCallback(frameCallbackId: number): void {\n    this.manageStateFrameCallback(frameCallbackId, false);\n    this.frameCallbackRegistry.delete(frameCallbackId);\n  }\n\n  manageStateFrameCallback(frameCallbackId: number, state: boolean): void {\n    if (frameCallbackId === -1) {\n      return;\n    }\n    if (state) {\n      this.frameCallbackActive.add(frameCallbackId);\n      this.runAnimation();\n    } else {\n      this.frameCallbackActive.delete(frameCallbackId);\n    }\n  }\n}\n"],"mappings":";;;;;;;;;AAAe,MAAMA,qBAAN,CAA4B;EAAA;IAAA,wCAChB,CADgB;;IAAA,+CAET,IAAIC,GAAJ,EAFS;;IAAA,6CAGX,IAAIC,GAAJ,EAHW;;IAAA,gDAIR,KAJQ;EAAA;;EAMjCC,YAAY,GAAG;IACrB,MAAMC,IAAI,GAAG,MAAM;MACjB,KAAKC,mBAAL,CAAyBC,OAAzB,CAAkCC,GAAD,IAAS;QACxC,MAAMC,QAAQ,GAAG,KAAKC,qBAAL,CAA2BC,GAA3B,CAA+BH,GAA/B,CAAjB;QACAC,QAAQ;MACT,CAHD;;MAKA,IAAI,KAAKH,mBAAL,CAAyBM,IAAzB,GAAgC,CAApC,EAAuC;QACrCC,qBAAqB,CAACR,IAAD,CAArB;MACD,CAFD,MAEO;QACL,KAAKS,sBAAL,GAA8B,KAA9B;MACD;IACF,CAXD;;IAaA,IAAI,CAAC,KAAKA,sBAAV,EAAkC;MAChCD,qBAAqB,CAACR,IAAD,CAArB;MACA,KAAKS,sBAAL,GAA8B,IAA9B;IACD;EACF;;EAEDC,qBAAqB,CAACN,QAAD,EAA+B;IAClD,IAAI,CAACA,QAAL,EAAe;MACb,OAAO,CAAC,CAAR;IACD;;IACD,MAAMO,UAAU,GAAG,KAAKC,cAAxB;IACA,KAAKA,cAAL;IACA,KAAKP,qBAAL,CAA2BQ,GAA3B,CAA+BF,UAA/B,EAA2CP,QAA3C;IAEA,OAAOO,UAAP;EACD;;EAEDG,uBAAuB,CAACC,eAAD,EAAgC;IACrD,KAAKC,wBAAL,CAA8BD,eAA9B,EAA+C,KAA/C;IACA,KAAKV,qBAAL,CAA2BY,MAA3B,CAAkCF,eAAlC;EACD;;EAEDC,wBAAwB,CAACD,eAAD,EAA0BG,KAA1B,EAAgD;IACtE,IAAIH,eAAe,KAAK,CAAC,CAAzB,EAA4B;MAC1B;IACD;;IACD,IAAIG,KAAJ,EAAW;MACT,KAAKjB,mBAAL,CAAyBkB,GAAzB,CAA6BJ,eAA7B;MACA,KAAKhB,YAAL;IACD,CAHD,MAGO;MACL,KAAKE,mBAAL,CAAyBgB,MAAzB,CAAgCF,eAAhC;IACD;EACF;;AApDwC"}